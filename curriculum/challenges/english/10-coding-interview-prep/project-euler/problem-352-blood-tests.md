---
id: 5900f4cd1000cf542c50ffdf
title: 'Problem 352: Blood tests'
challengeType: 5
forumTopicId: 302012
dashedName: problem-352-blood-tests
---

# --description--

แกะ 25 ตัวแต่ละตัวในฝูงต้องได้รับการทดสอบหาไวรัสหายาก ซึ่งทราบกันดีว่ามีผลกระทบต่อประชากรแกะ 2%

มีการทดสอบ PCR ที่แม่นยำและละเอียดอ่อนอย่างยิ่งสำหรับตัวอย่างเลือด ซึ่งให้ผลบวก/ลบที่ชัดเจน แต่ใช้เวลานานและมีราคาแพง

เนื่องจากมีค่าใช้จ่ายสูง สัตวแพทย์แนะนำว่าแทนที่จะทำการทดสอบแยกกัน 25 ครั้ง สามารถใช้ขั้นตอนต่อไปนี้แทนได้

แบ่งแกะออกเป็น 5 กลุ่ม กลุ่มละ 5 ตัว  
ในแต่ละกลุ่ม จะผสม 5 ตัวอย่างเข้าด้วยกัน และทำการทดสอบครั้งเดียว จากนั้น

- ถ้าผลลัพธ์เป็นลบ แกะทั้งหมดในกลุ่มนั้นถือว่าปลอดไวรัส
- ถ้าผลเป็นบวก จะทำการทดสอบเพิ่มเติม 5 ครั้ง (แยกการทดสอบสำหรับสัตว์แต่ละตัว) เพื่อระบุตัวที่ติดไวรัส

เนื่องจากความน่าจะเป็นของการติดเชื้อในสัตว์ชนิดใดชนิดหนึ่งมีเพียง 0.02 เท่านั้น การทดสอบครั้งแรก (ในตัวอย่างที่รวบรวมไว้) สำหรับแต่ละกลุ่มจะเป็นดังนี้

- เป็นลบ (และไม่จำเป็นต้องทำการทดสอบเพิ่มเติม) โดยมีความน่าจะเป็น ${0.98}^5 = 0.9039207968$
- เป็นบวก (จำเป็นต้องมีการทดสอบเพิ่มเติม 5 ครั้ง) โดยมีความน่าจะเป็น $1 - 0.9039207968 = 0.0960792032$

ดังนั้น จำนวนการทดสอบที่คาดไว้สำหรับแต่ละกลุ่มคือ $1 + 0.0960792032 × 5 = 1.480396016$

ดังนั้น ทั้ง 5 กลุ่มสามารถคัดกรองได้โดยใช้ค่าเฉลี่ยเพียง $1.480396016 × 5 = \mathbf{7.40198008}$ การทดสอบ ซึ่งแสดงถึงการประหยัดมากกว่า 70%!

แม้ว่ารูปแบบที่เราเพิ่งอธิบายไปดูเหมือนจะมีประสิทธิภาพมาก แต่ก็ยังสามารถปรับปรุงได้อย่างมาก (โดยสมมติเสมอว่าการทดสอบมีความละเอียดอ่อนเพียงพอและไม่มีผลกระทบที่เกิดจากการผสมตัวอย่างต่างๆ) เช่น:

- เราอาจเริ่มต้นด้วยการทดสอบกับตัวอย่างทั้งหมด 25 ตัวอย่าง สามารถตรวจสอบได้ว่าในประมาณ 60.35% ของกรณีการทดสอบนี้จะเป็นลบ ดังนั้นจึงไม่จำเป็นต้องทำการทดสอบอีก จำเป็นต้องมีการทดสอบเพิ่มเติมสำหรับกรณีที่เหลือ 39.65% เท่านั้น
- หากเรารู้ว่าสัตว์อย่างน้อยหนึ่งตัวในกลุ่ม 5 ตัวติดเชื้อและการทดสอบเดี่ยว 4 ตัวแรกออกมาเป็นลบ ไม่จำเป็นต้องทำการทดสอบกับสัตว์ตัวที่ห้า (เรารู้ว่าต้องติดเชื้อ)
- เราสามารถลองจำนวนกลุ่มที่แตกต่างกัน / จำนวนสัตว์ที่แตกต่างกันในแต่ละกลุ่มโดยปรับตัวเลขเหล่านั้นในแต่ละระดับเพื่อลดจำนวนการทดสอบที่คาดหวังทั้งหมด

เพื่อลดความซับซ้อนของความเป็นไปได้ที่หลากหลาย มีข้อจำกัด ประการหนึ่งที่เรากำหนดไว้เมื่อคิดแผนการทดสอบที่คุ้มค่าที่สุด: 

เมื่อใดก็ตามที่เราเริ่มต้นด้วยตัวอย่างแบบผสม แกะทั้งหมดที่มีส่วนร่วมในตัวอย่างนั้นจะต้องได้รับการตรวจคัดกรองอย่างสมบูรณ์ (เช่น สรุปว่ามี/ไม่มีเชื้อ) ก่อนที่เราจะเริ่มตรวจสัตว์อื่นๆ

สำหรับตัวอย่างปัจจุบัน ปรากฎว่าแผนการทดสอบที่คุ้มค่าที่สุด (เราจะเรียกว่ากลยุทธ์ที่เหมาะสมที่สุด) ค่าเฉลี่ยของการทดสอบเป็น <strong>4.155452</strong>

ใช้กลยุทธ์ที่เหมาะสมที่สุด ให้ $T(s, p)$ แทนจำนวนการทดสอบโดยเฉลี่ย ที่จำเป็นในการคัดกรองฝูงแกะ $s$ สำหรับไวรัสที่มีความเป็นไปได้ที่ $p$ จะปรากฏในแต่ละตัว และปัดเศษเป็นทศนิยมหกตำแหน่ง $T(25, 0.02) = 4.155452$ และ $T(25, 0.10) = 12.702124$

ให้หา $\sum T(10\\,000, p)$ ถ้า $p = 0.01, 0.02, 0.03, \ldots 0.50$ และปัดเศษเป็นทศนิยมหกตำแหน่ง

# --hints--

`bloodTests()` ต้องคืนค่าเป็น `378563.260589`

```js
assert.strictEqual(bloodTests(), 378563.260589);
```

# --seed--

## --seed-contents--

```js
function bloodTests() {

  return true;
}

bloodTests();
```

# --solutions--

```js
// solution required
```
